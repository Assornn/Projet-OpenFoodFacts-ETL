{
  "run_timestamp": "2025-12-15T13:41:21.783772",
  "status": "failed",
  "bronze": {
    "products_read": 25,
    "source_path": "data/raw/openfoodfacts_sample.csv"
  },
  "silver": {
    "products_input": 25,
    "products_filtered": 25,
    "products_rejected": 0,
    "rejection_rate_pct": 0.0,
    "duplicates_removed": 0,
    "avg_completeness": 0.368,
    "completeness_pct": 36.8,
    "anomalies": {
      "total_products_with_anomalies": 0,
      "anomaly_rate_pct": 0.0,
      "by_rule": {}
    }
  },
  "error": "[UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `last_modified_date` cannot be resolved. Did you mean one of the following? [`last_modified_t`, `categories`, `product_name`, `sodium_100g`, `code`].;\n'Project ['last_modified_date AS date#10282]\n+- Project [code#745, product_name#746, brands#747, categories#748, countries#749, last_modified_t#20, nutriscore_grade#750, nova_group#18, ecoscore_grade#751, energy_kcal_100g#1840, energy_kj_100g#1851, fat_100g#1863, saturated_fat_100g#1876, carbohydrates_100g#1890, sugars_100g#1905, fiber_100g#1921, proteins_100g#1938, salt_100g#1995, sodium_100g#2015, completeness_score#3174, filter(quality_issues#3195, lambdafunction(isnotnull(lambda x#3218), lambda x#3218, false)) AS quality_issues#3217]\n   +- Project [code#745, product_name#746, brands#747, categories#748, countries#749, last_modified_t#20, nutriscore_grade#750, nova_group#18, ecoscore_grade#751, energy_kcal_100g#1840, energy_kj_100g#1851, fat_100g#1863, saturated_fat_100g#1876, carbohydrates_100g#1890, sugars_100g#1905, fiber_100g#1921, proteins_100g#1938, salt_100g#1995, sodium_100g#2015, completeness_score#3174, array(CASE WHEN (sugars_100g#1905 > cast(100 as double)) THEN sugars_out_of_bounds END, CASE WHEN (salt_100g#1995 > cast(25 as double)) THEN salt_out_of_bounds END, CASE WHEN (fat_100g#1863 > cast(100 as double)) THEN fat_out_of_bounds END, CASE WHEN (proteins_100g#1938 > cast(100 as double)) THEN proteins_out_of_bounds END, CASE WHEN (energy_kcal_100g#1840 > cast(900 as double)) THEN energy_out_of_bounds END, CASE WHEN (energy_kcal_100g#1840 < cast(0 as double)) THEN negative_energy END, CASE WHEN (sugars_100g#1905 < cast(0 as double)) THEN negative_sugars END, CASE WHEN (salt_100g#1995 < cast(0 as double)) THEN negative_salt END) AS quality_issues#3195]\n      +- Project [code#745, product_name#746, brands#747, categories#748, countries#749, last_modified_t#20, nutriscore_grade#750, nova_group#18, ecoscore_grade#751, energy_kcal_100g#1840, energy_kj_100g#1851, fat_100g#1863, saturated_fat_100g#1876, carbohydrates_100g#1890, sugars_100g#1905, fiber_100g#1921, proteins_100g#1938, salt_100g#1995, sodium_100g#2015, (cast(((((CASE WHEN isnotnull(product_name#746) THEN 1 ELSE 0 END + CASE WHEN isnotnull(brands#747) THEN 1 ELSE 0 END) + CASE WHEN isnotnull(energy_kcal_100g#1840) THEN 1 ELSE 0 END) + CASE WHEN isnotnull(fat_100g#1863) THEN 1 ELSE 0 END) + CASE WHEN isnotnull(sugars_100g#1905) THEN 1 ELSE 0 END) as double) / cast(5.0 as double)) AS completeness_score#3174]\n         +- Project [code#745, product_name#746, brands#747, categories#748, countries#749, last_modified_t#20, nutriscore_grade#750, nova_group#18, ecoscore_grade#751, energy_kcal_100g#1840, energy_kj_100g#1851, fat_100g#1863, saturated_fat_100g#1876, carbohydrates_100g#1890, sugars_100g#1905, fiber_100g#1921, proteins_100g#1938, salt_100g#1995, sodium_100g#2015]\n            +- Filter (row_num#2585 = 1)\n               +- Project [code#745, product_name#746, brands#747, categories#748, countries#749, last_modified_t#20, nutriscore_grade#750, nova_group#18, ecoscore_grade#751, energy_kcal_100g#1840, energy_kj_100g#1851, fat_100g#1863, saturated_fat_100g#1876, carbohydrates_100g#1890, sugars_100g#1905, fiber_100g#1921, proteins_100g#1938, salt_100g#1995, sodium_100g#2015, row_num#2585]\n                  +- Project [code#745, product_name#746, brands#747, categories#748, countries#749, last_modified_t#20, nutriscore_grade#750, nova_group#18, ecoscore_grade#751, energy_kcal_100g#1840, energy_kj_100g#1851, fat_100g#1863, saturated_fat_100g#1876, carbohydrates_100g#1890, sugars_100g#1905, fiber_100g#1921, proteins_100g#1938, salt_100g#1995, sodium_100g#2015, row_num#2585, row_num#2585]\n                     +- Window [row_number() windowspecdefinition(code#745, last_modified_t#20 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS row_num#2585], [code#745], [last_modified_t#20 DESC NULLS LAST]\n                        +- Project [code#745, product_name#746, brands#747, categories#748, countries#749, last_modified_t#20, nutriscore_grade#750, nova_group#18, ecoscore_grade#751, energy_kcal_100g#1840, energy_kj_100g#1851, fat_100g#1863, saturated_fat_100g#1876, carbohydrates_100g#1890, sugars_100g#1905, fiber_100g#1921, proteins_100g#1938, salt_100g#1995, sodium_100g#2015]\n                           +- Project [code#745, product_name#746, brands#747, categories#748, countries#749, last_modified_t#20, nutriscore_grade#750, nova_group#18, ecoscore_grade#751, energy_kcal_100g#1840, energy_kj_100g#1851, fat_100g#1863, saturated_fat_100g#1876, carbohydrates_100g#1890, sugars_100g#1905, fiber_100g#1921, proteins_100g#1938, salt_100g#1995, CASE WHEN (isnull(sodium_100g#1975) AND isnotnull(salt_100g#1995)) THEN (salt_100g#1995 / 2.5) ELSE sodium_100g#1975 END AS sodium_100g#2015]\n                              +- Project [code#745, product_name#746, brands#747, categories#748, countries#749, last_modified_t#20, nutriscore_grade#750, nova_group#18, ecoscore_grade#751, energy_kcal_100g#1840, energy_kj_100g#1851, fat_100g#1863, saturated_fat_100g#1876, carbohydrates_100g#1890, sugars_100g#1905, fiber_100g#1921, proteins_100g#1938, CASE WHEN (isnull(salt_100g#1956) AND isnotnull(sodium_100g#1975)) THEN (sodium_100g#1975 * 2.5) ELSE salt_100g#1956 END AS salt_100g#1995, sodium_100g#1975]\n                                 +- Project [code#745, product_name#746, brands#747, categories#748, countries#749, last_modified_t#20, nutriscore_grade#750, nova_group#18, ecoscore_grade#751, energy_kcal_100g#1840, energy_kj_100g#1851, fat_100g#1863, saturated_fat_100g#1876, carbohydrates_100g#1890, sugars_100g#1905, fiber_100g#1921, proteins_100g#1938, salt_100g#1956, cast(null as double) AS sodium_100g#1975]\n                                    +- Project [code#745, product_name#746, brands#747, categories#748, countries#749, last_modified_t#20, nutriscore_grade#750, nova_group#18, ecoscore_grade#751, energy_kcal_100g#1840, energy_kj_100g#1851, fat_100g#1863, saturated_fat_100g#1876, carbohydrates_100g#1890, sugars_100g#1905, fiber_100g#1921, proteins_100g#1938, cast(null as double) AS salt_100g#1956]\n                                       +- Project [code#745, product_name#746, brands#747, categories#748, countries#749, last_modified_t#20, nutriscore_grade#750, nova_group#18, ecoscore_grade#751, energy_kcal_100g#1840, energy_kj_100g#1851, fat_100g#1863, saturated_fat_100g#1876, carbohydrates_100g#1890, sugars_100g#1905, fiber_100g#1921, cast(null as double) AS proteins_100g#1938]\n                                          +- Project [code#745, product_name#746, brands#747, categories#748, countries#749, last_modified_t#20, nutriscore_grade#750, nova_group#18, ecoscore_grade#751, energy_kcal_100g#1840, energy_kj_100g#1851, fat_100g#1863, saturated_fat_100g#1876, carbohydrates_100g#1890, sugars_100g#1905, cast(null as double) AS fiber_100g#1921]\n                                             +- Project [code#745, product_name#746, brands#747, categories#748, countries#749, last_modified_t#20, nutriscore_grade#750, nova_group#18, ecoscore_grade#751, energy_kcal_100g#1840, energy_kj_100g#1851, fat_100g#1863, saturated_fat_100g#1876, carbohydrates_100g#1890, cast(null as double) AS sugars_100g#1905]\n                                                +- Project [code#745, product_name#746, brands#747, categories#748, countries#749, last_modified_t#20, nutriscore_grade#750, nova_group#18, ecoscore_grade#751, energy_kcal_100g#1840, energy_kj_100g#1851, fat_100g#1863, saturated_fat_100g#1876, cast(null as double) AS carbohydrates_100g#1890]\n                                                   +- Project [code#745, product_name#746, brands#747, categories#748, countries#749, last_modified_t#20, nutriscore_grade#750, nova_group#18, ecoscore_grade#751, energy_kcal_100g#1840, energy_kj_100g#1851, fat_100g#1863, cast(null as double) AS saturated_fat_100g#1876]\n                                                      +- Project [code#745, product_name#746, brands#747, categories#748, countries#749, last_modified_t#20, nutriscore_grade#750, nova_group#18, ecoscore_grade#751, energy_kcal_100g#1840, energy_kj_100g#1851, cast(null as double) AS fat_100g#1863]\n                                                         +- Project [code#745, product_name#746, brands#747, categories#748, countries#749, last_modified_t#20, nutriscore_grade#750, nova_group#18, ecoscore_grade#751, energy_kcal_100g#1840, cast(null as double) AS energy_kj_100g#1851]\n                                                            +- Project [code#745, product_name#746, brands#747, categories#748, countries#749, last_modified_t#20, nutriscore_grade#750, nova_group#18, ecoscore_grade#751, cast(null as double) AS energy_kcal_100g#1840]\n                                                               +- Filter ((isnotnull(code#745) AND (length(code#745) >= 8)) AND RLIKE(code#745, ^[0-9]+$))\n                                                                  +- Project [trim(code#0, None) AS code#745, coalesce(trim(product_name_fr#2, None), trim(product_name_en#3, None), trim(product_name#1, None)) AS product_name#746, trim(brands#4, None) AS brands#747, trim(categories#5, None) AS categories#748, trim(countries#6, None) AS countries#749, last_modified_t#20, lower(trim(nutriscore_grade#17, None)) AS nutriscore_grade#750, nova_group#18, lower(trim(ecoscore_grade#19, None)) AS ecoscore_grade#751]\n                                                                     +- Relation [code#0,product_name#1,product_name_fr#2,product_name_en#3,brands#4,categories#5,countries#6,energy-kcal_100g#7,energy-kj_100g#8,fat_100g#9,saturated-fat_100g#10,carbohydrates_100g#11,sugars_100g#12,fiber_100g#13,proteins_100g#14,salt_100g#15,sodium_100g#16,nutriscore_grade#17,nova_group#18,ecoscore_grade#19,last_modified_t#20] csv\n",
  "duration_seconds": 7.34685
}