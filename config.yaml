# ============================================================
# MOD√àLE DE CONFIGURATION (TEMPLATE)
# Copiez ce fichier en 'config.local.yaml' et remplissez vos valeurs.
# ============================================================

spark:
  app_name: "OpenFoodFacts ETL"
  master: "local[*]"
  driver_memory: "4g"
  executor_memory: "4g"

  # ‚ö†Ô∏è CHEMIN VERS LE DRIVER JDBC MYSQL
  # Exemple Windows : "file:///C:/spark/jars/mysql-connector-j-9.5.0.jar"
  # Exemple Linux/Mac : "/usr/local/spark/jars/mysql-connector-j-9.5.0.jar"
  jars: "chemin/vers/votre/mysql-connector-j.jar"

# ============================================================
# MySQL - DataMart GOLD
# ============================================================

mysql:
  host: "localhost"
  port: 3306
  database: "openfoodfacts"
  user: "root"
  
  # üîí MOT DE PASSE (√Ä remplir uniquement dans config.local.yaml)
  password: "CHANGE_ME"

  # Param√®tres de connexion (UTF-8 et Timezone sont importants pour Spark)
  jdbc_url: "jdbc:mysql://localhost:3306/openfoodfacts?useUnicode=true&characterEncoding=utf8&serverTimezone=Europe/Paris&rewriteBatchedStatements=true"
  driver: "com.mysql.cj.jdbc.Driver"

# ============================================================
# OpenFoodFacts - Source de donn√©es
# ============================================================

openfoodfacts:
  # Source officielle
  source_url: "https://static.openfoodfacts.org/data/en.openfoodfacts.org.products.csv.gz"

  # Chemin local du fichier (relatif √† la racine du projet)
  raw_data_path: "data/raw/en.openfoodfacts.org.products.csv.gz"

  # Format du fichier source
  format: "csv"
  delimiter: "\t"
  header: true
  encoding: "utf-8"

# ============================================================
# BRONZE - Param√®tres d'extraction
# ============================================================

bronze:
  # Limite de lignes pour le d√©buggage (commenter pour la prod)
  # limit_rows: 1000

# ============================================================
# SILVER - R√®gles de Qualit√©
# ============================================================

quality:
  completeness:
    product_name: 0.95
    nutrients_key: 0.70

  rules:
    bounds:
      sugars_100g: [0, 100]
      salt_100g: [0, 25]
      fat_100g: [0, 100]
      proteins_100g: [0, 100]
      energy_kcal_100g: [0, 900]

# ============================================================
# Pipeline ETL
# ============================================================

pipeline:
  phases:
    - bronze
    - silver
    - gold

  execution:
    mode: "batch"
    checkpoint_enabled: true